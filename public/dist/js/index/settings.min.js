define(["jquery","template","tool","ckeditor","uploadify","region","jquery_cookie"],function(e,t,a,i){e(function(){e.ajax({type:"get",url:"/api/teacher/profile",success:function(o){if(console.log(o),200==o.code){var r=t("teacher_profile_tp1",o.result);e(".teacher-profile").html(r),a.setDate("#tc_birthday"),a.setDate("#tc_join_date"),e("#upfile").uploadify({height:120,swf:"/public/assets/uploadify/uploadify.swf",uploader:"/api/uploader/avatar",fileObjName:"tc_avatar",width:120,fileSizeLimit:"5MB",buttonText:"",onUploadSuccess:function(t,a){var i=(a=JSON.parse(a)).result.path;e(".preview img").attr("src",i),e("#userinfo img").attr("src",i);var o=e.cookie("userinfo");(o=JSON.parse(o)).tc_avatar=i,e.cookie("userinfo",JSON.stringify(o),{path:"/",expires:1})}}),e("#hometown").region({url:"/public/assets/jquery-region/region.json"}),i.replace("tc_introduce",{toolbarGroups:[{name:"clipboard",groups:["clipboard","undo"]},{name:"forms"},{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"paragraph",groups:["list","indent","blocks","align","bidi"]},{name:"styles"},{name:"colors"}]})}}}),e("body").on("click",".btn_save",function(){i.instances.tc_introduce.updateElement(),e.ajax({type:"post",url:"/api/teacher/modify",data:e("form").serialize(),success:function(e){200==e.code&&(location.href="/settings")}})})})});